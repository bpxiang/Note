# 中断线程

当线程的 run 方法执行方法体中最后一条语句后，并经由执行 return 语句返回时，或者出现了在方法中没有捕获的异常时，线程将终止。在 Java 的早期版本中，还有一个 stop 方法，其他线程可以调用它终止线程。但是，这个方法现在已经被弃用。

没有可以强制线程终止的方法。然而，interrupt 方法可以用来请求终止线程。

当对一个线程调用 interrupt 方法时，线程的中断状态将被置位。这是每一个线程都具有的 boolean 标志。每个线程都应该不时地检查这个标志，以判断线程是否被中断。

要想弄清中断状态是否被置位，首先调用静态的 Thread.currentThread 方法获得当前线程，然后调用 isInterrupted 方法：

```java
while(!Thread.currentThread().isInterrupted() && more work to do) {
    do more work
}
```

但是，如果线程被阻塞，就无法检测中断状态。这是产生 interruptedException 异常的地方。当在一个被阻塞的线程（调用 sleep 或 wait）上调用 interrupt 方法时，阻塞调用将会被 Interrupted Exception 中断。（存在不能被中断的阻塞 I/O 调用，应该考虑选择可中断的调用）。

没有任何语言方面的需求要求一个被中断的线程应该终止。中断一个线程不过是引起它的注意。被中断的线程可以决定如何响应中断。某些线程是如此重要以至于应该处理完异常后，继续执行，而不理会中断。但是，更普遍的情况是，线程将简单地将中断作为一个终止的请求，。这种线程的 run 方法具有如下形式：
```java
Runnable r = () -> {
    try{
        ...
        while (!Thread.currentThread().isInterrupted() && more work to do) {
            do more work
        }catch(InterruptedException e) {
            // thread was interrupted during sleep or wait
        }finally {
            cleanup, if required
        }
        // exiting the run method terminates the thread
    }
}
```

p650