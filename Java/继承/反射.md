# 反射
>time: 2018-02-05 15:30:40  

反射库（ reflection library) 提供了一个非常丰富且精心设计的工具集， 以便编写能够动态操纵 Java 代码的程序。这项功能被大量地应用于 JavaBeans 中， 它是 Java 组件的体系结构。使用反射，Java 可以支持 Visual Basic 用户习惯使用的工具。特别是在设计或运行中添加新类时，能够快速地应用开发工具动态地查询新添加类的能力。

能够分析类能力的程序称为反射（reflective)。反射机制的功能极其强大，在下面可以看到， 反射机制可以用来：
* 在运行时分析类的能力
* 在运行时查看对象，例如，编写一个 toString 方法提供所有类使用。
* 实现通用的数组操作代码。
* 利用 Method 对象，这个对象很像 C++ 中的函数指针。

反射是一种功能强大且复杂的机制。使用它的主要人员是工具构造者，而不是应用程序员。

## 1. Class 类

在程序运行期间，Java运行时系统始终为所有的对象维护一个被称为运行时的类型标识。这个信息跟踪着每个对象所属的类。 虚拟机利用运行时类型信息选择相应的方法执行。保存这些信息的类被称为 Class, 这 个 名
字很容易让人混淆。Object 类中的 getClass() 方法将会返回一个 Class类型的实例。

```java
Employee e = new Employee("Test", 10000, 2018, 2, 5);
Class cl = e.getClass();
```

Class对象将表示一个特定类的属性。  
getName() 方法将返回类的名字  
Class 静态方法 forName(String className) 获得类名对应的 Class 对象。这个方法只有在 className 是类名或接口名时才能够执行。否则，forName方法将抛出一个 checked exception ( 已检查异常）。无论何时使用这个方法，都应该提供一个异常处理器（ exception handler)。   
```java
try {
    String className = "java.util.Random";
    Class cl = Class.forName(className);
} catch (ClassNotFoundException e) {
    e.printStackTrace();
}
```

提示：在启动时，包含 main 方法的类被加载。它会加载所有需要的类。这些被加栽的类又要加载它们需要的类，以此类推。对于一个大型的应用程序来说，这将会消耗很多时间，用户会因此感到不耐烦。可以使用下面这个技巧给用户一种启动速度比较快的幻觉。不过，要确保包含 main 方法的类没有显式地引用其他的类。首先，显示一个启动画面；然后，通过调用 Class.forName 手工地加载其他的类。

### 获得 Class 类对象的三种方法
1. `cl.getClass()`
2. `Class.forName(String className);`
3. `Class cl1 = Random.class; Class cl2 = int.class; Class cl3 = Double[].class;`

请注意， 一个 Class 对象实际上表示的是一个类型，而这个类型未必一定是一种类。例如，int不是类，但 int.class 是一个 Class 类型的对象。

**注释**： Class类实际上是一个泛型类。例如，Employee.class 的类型是 Class<Employee>。没有说明这个问题的原因是：它将已经抽象的概念更加复杂化了。在大多数实际问题中，可以忽略类型参数，而使用原始的 Class 类。

虚拟机为每个类型管理一个 Class对象。因此，可以利用 == 运算符实现两个类对象比较的操作。 例如
```java
if (e.getClass() ==)
```