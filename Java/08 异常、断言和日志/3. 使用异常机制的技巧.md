## 使用异常机制的技巧
>time: 2018-03-23 09:59:56

使用异常的基本规则是：只在异常情况下使用异常机制。

异常处理机制的其中一个目标，将正常处理与错误处理分开。

#### 使用异常机制的几个技巧:
1. 异常处理不能代替简单的测试
    >与执行简单的测试相比，捕获异常所花费的时间大大超过了前者， 因此使用异常的基本规则是：只在异常情况下使用异常机制。
1. 不要过分地细化异常
    >有必要将整个任务包装在一个 try 语句块中，这样，当任何一个操作出现问题时，整个任务都可以取消。  
    >异常处理机制的其中一个目标，将正常处理与错误处理分开。
1. 利用异常层次结构
    >不要只抛出 RuntimeException 异常。应该寻找更加适当的子类或创建自己的异常类。   
    >不要只捕获 Thowable 异常，否则，会使程序代码更难读、更难维护。  
    >考虑受查异常与非受查异常的区别。已检查异常本来就很庞大，不要为逻辑错误抛出这些异常。（例如，反射库的做法就不正确。 调用者却经常需要捕获那些早已知道不可能发生的异常。）  
    >将一种异常转换成另一种更加适合的异常时不要犹豫。例如，在解析某个文件中的一个整数时，捕获 NumberFormatException 异常，然后将它转换成 IOException 或 MySubsystemException 的子类。
1. 不要压制异常
    >在 Java 中，往往强烈地倾向关闭异常。如果编写了一个调用另一个方法的方法，而这个方法有可能 100 年才抛出一个异常，那么，编译器会因为没有将这个异常列在 throws 表中产生抱怨。而没有将这个异常列在 throws 表中主要出于编译器将会对所有调用这个方法的方法进行异常处理的考虑。因此，应该将这个异常关闭：
    ```java
    public Image loadImage(Strig s) {
        try {
            // code that threatens to throw checked exceptions
        } catch (Exception e) 
        {} // so there
    }
    ```
1. 在检测错误时，“苛刻”要比放任更好
    >当检测到错误的时候，有些程序员担心抛出异常。在用无效的参数调用一个方法时，返回一个虚拟的数值，还是抛出一个异常，哪种处理方式更好？例如，当栈空时，Stack.pop 是返回一个 null，还是抛出一个异常？我们认为：在出错的地方抛出一个 EmptyStackException 异常要比在后面抛出一个 NullPointerException 异常更好。
1. 不要羞于传递异常
    >很多程序员都感觉应该捕获抛出的全部异常。如果调用了一个抛出异常的方法，例如，FilelnputStream 构造器或 readLine 方法，这些方法就会本能地捕获这些可能产生的异常。其实，传递异常要比捕获这些异常更好：  
    ```java
    public void readStuff(String filename) throws IOException // not a sign of shame!
    {
        InputStream in = new FileInputStream(filename);
    }
    ```
    >让高层次的方法通知用户发生了错误，或者放弃不成功的命令更加适宜。